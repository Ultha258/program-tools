/*! Built with http://stenciljs.com */
const{h:e}=window.WidgetComponents;import{a as r}from"./chunk-2b5ffdc4.js";import{a as t}from"./chunk-4e957c27.js";import{d as a}from"./chunk-bf7ffeb2.js";import{a as s}from"./chunk-eeb26f85.js";import"./chunk-7081a6f1.js";class n{getName(){const e=this.referral,r=this.referral;return e.referredUser?e.referredUser.firstName||this.unknownuser:r.referrerUser&&r.referrerUser.firstName||this.unknownuser}getIcon(){return"converted"!==this.referraltype&&"referrer"!==this.referraltype||this.rewardIsExpired()||this.rewardIsCancelled()?"icon-attention":"icon-ok-circled"}getContent(e){return this.rewardIsExpired()&&this.referralvariables.expiredcontent?r.format(this.referralvariables.expiredcontent,e):this.rewardIsCancelled()&&this.referralvariables.cancelledcontent?r.format(this.referralvariables.cancelledcontent,e):this.referraltype?r.format(this.referralvariables[`${this.referraltype}content`],e):""}rewardIsExpired(){const{rewards:e}=this.referral;return 1==e.length&&e[0].statuses&&e[0].statuses.indexOf("EXPIRED")>-1}rewardIsCancelled(){const{rewards:e}=this.referral;return 1==e.length&&e[0].statuses&&e[0].statuses.indexOf("CANCELLED")>-1}getValue(){const{rewards:e}=this.referral,r=this.referralvariables.referrervalue,t=this.referralvariables.pendingvalue;return 0==e.length?"referrer"===this.referraltype?r:t:e.length>0&&this.referralvariables.usefirstreward&&e[e.length-1].prettyValue||e[0].prettyValue}getValueContent(e){const{rewards:t}=this.referral;return 1==t.length&&this.rewardIsExpired()?r.format(this.referralvariables.expiredvalue,e):1==t.length&&this.rewardIsCancelled()?r.format(this.referralvariables.cancelledvalue,e):t.length<=1?"":r.format(this.referralvariables.valuecontent,e)}render(){const{dateReferralStarted:t,rewards:a}=this.referral,s={date:r.formatRelative(t.toString()),extrarewards:a.length-1},n=this.getName(),l=this.getIcon(),i=this.getContent(s),o=this.getValue(),c=this.getValueContent(s);return e("div",{class:"squatch-referrals-row"},e("div",null,e("div",{class:"squatch-referrals-heading"},n),e("div",{class:"squatch-referrals-description"},i)),e("i",{class:`icon squatch-referrals-icon ${l} ${this.rewardIsExpired()&&"expired"} ${this.rewardIsCancelled()&&"cancelled"}`}),e("div",{class:"sqh-column-two"},e("div",{class:`squatch-referrals-value ${this.rewardIsCancelled()&&"cancelled"} ${a.length>0?this.rewardIsExpired()?"expired":"":"referrer"===this.referraltype?"referrer":"pending"}`},o),e("div",{class:`squatch-value-contents ${this.rewardIsExpired()&&"expired"} ${this.rewardIsCancelled()&&"cancelled"}`},c)))}static get is(){return"sqh-referral-component"}static get properties(){return{referral:{type:"Any",attr:"referral"},referraltype:{type:String,attr:"referraltype"},referralvariables:{type:"Any",attr:"referralvariables"},unknownuser:{type:"Any",attr:"unknownuser"}}}static get style(){return"sqh-referral-component:nth-child(3) .squatch-referrals-row{border-bottom:none}sqh-referral-component .squatch-referrals-row{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-align:center;-webkit-box-align:center;align-items:center;height:80px;border-bottom:1px solid #ececec;max-width:500px;margin:0 auto;padding:0 20px;line-height:1.6}sqh-referral-component .squatch-referrals-row>div:first-of-type{-ms-flex:1;-webkit-box-flex:1;flex:1}sqh-referral-component .squatch-referrals-row .icon{float:left;font-size:32px}sqh-referral-component .squatch-referrals-row .sqh-column-two{padding:10px 0}sqh-referral-component .squatch-referrals-value{width:175px;font-size:16px;float:left;line-height:49px}sqh-referral-component .squatch-value-contents{font-size:13px;line-height:0;padding-bottom:25px}sqh-referral-component .squatch-referrals-heading{font-size:16px}sqh-referral-component .squatch-referrals-description{font-size:13px}\@media (max-width:499px){sqh-referral-component .squatch-referrals-description{display:none}sqh-referral-component .squatch-referrals-row{padding:0}sqh-referral-component .squatch-referrals-row>div:first-of-type{width:100px;overflow:hidden}}"}}class l{constructor(){this.ishidden=!1,this.showreferrer=!0,this.usefirstreward=!1,this.offset=0,this.loading=!0}componentWillLoad(){if(!this.ishidden)return this.getReferrals().then(e=>{this.referrals=e.referrals.data,this.referredBy=e.referredByReferral,this.referralsCount=e.referrals.totalCount,this.loading=!1}).catch(e=>{this.onError(e)})}getReferrals(e=0){return s.graphql.getReferrals(e)}paginate(e,r){if(this.loading)return null;let{referralsCount:t}=this;if(this.showreferrer&&this.referredBy&&t++,e>=t||e<0)return null;this.loading=!0;const{target:a}=r;a.innerText="...",this.getReferrals(e).then(r=>{a.innerText=e>this.offset?this.paginatemore:this.paginateless,this.referrals=r.referrals.data,this.offset=e,this.loading=!1})}onError(e){console.error(e),this.loading=!1}render(){let r,s;const n={usefirstreward:this.usefirstreward,referrercontent:this.referrercontent,convertedcontent:this.convertedcontent,pendingcontent:this.pendingcontent,pendingvalue:this.pendingvalue,referrervalue:this.referrervalue,valuecontent:this.valuecontent,expiredcontent:this.expiredcontent,expiredvalue:this.expiredvalue,cancelledvalue:this.cancelledvalue,cancelledcontent:this.cancelledcontent};this.referrals&&(s=this.referrals.map(r=>{const t=r.rewards.length>0?"converted":"pending";return e("sqh-referral-component",{id:a(),referral:r,referralvariables:n,referraltype:t,unknownuser:this.unknownuser})})),this.referrals.length<3&&this.referredBy&&this.showreferrer&&(r=e("sqh-referral-component",{id:a(),referral:this.referredBy,referralvariables:n,referraltype:"referrer",unknownuser:this.unknownuser}));const l=t`
      .squatch-referrals-icon.icon-ok-circled {
        color: ${this.rewardcolor};
      }
      .squatch-referrals-icon.icon-attention {
        color: ${this.pendingcolor};
      }
      .squatch-referrals-value {
        color: ${this.rewardcolor};
      }
      .squatch-referrals-value.pending {
        color: ${this.pendingcolor};
      }
      .squatch-referrals-value.referrer {
        color: ${this.rewardcolor};
      }
      .squatch-referrals-value.expired {
        color: ${this.expiredcolor};
      }
      .squatch-value-contents.expired {
        color: ${this.expiredcolor}
      }
      .squatch-referrals-icon.icon-attention.expired {
        color: ${this.expiredcolor}
      }
      .squatch-referrals-value.cancelled {
        color: ${this.cancelledcolor};
      }
      .squatch-value-contents.cancelled {
        color: ${this.cancelledcolor}
      }
      .squatch-referrals-icon.icon-attention.cancelled {
        color: ${this.cancelledcolor}
      }
      .squatch-referrals-heading {
        color: ${this.referralnamecolor};
      }
      .squatch-referrals-description,
      .squatch-referrals-value-content {
        color: ${this.referraltextcolor};
      }
      .squatch-referrals-scroll-action {
        font-family: ${"inherit"};
      }
    `,i=this.showreferrer&&this.referredBy?this.referralsCount+1:this.referralsCount;return!this.ishidden&&i>0?e("div",{class:`squatch-referrals ${l}`},e("div",{class:"squatch-referrals-scroll-container"},s,r),e("div",{class:"squatch-referrals-scroll-action-container"},e("button",{class:`\n                squatch-referrals-scroll-action previous ${this.loading?"disabled":0===this.offset?"disabled":""}\n              `,onClick:e=>this.paginate(this.offset-3,e)},this.paginateless),e("button",{class:`\n                squatch-referrals-scroll-action view-more ${this.loading?"disabled":this.showreferrer&&this.referredBy?this.offset>=this.referralsCount-2?"disabled":"":this.offset>=this.referralsCount-3?"disabled":""}\n              `,"view-more":!0,onClick:e=>this.paginate(this.offset+3,e)},this.paginatemore))):e("div",{class:"squatch-referrals-scroll-action-container"},e("button",{disabled:!0,class:"squatch-no-referrals-yet"},this.noreferralsyet))}static get is(){return"sqh-referral-list"}static get properties(){return{cancelledcolor:{type:String,attr:"cancelledcolor"},cancelledcontent:{type:String,attr:"cancelledcontent"},cancelledvalue:{type:String,attr:"cancelledvalue"},convertedcontent:{type:String,attr:"convertedcontent"},expiredcolor:{type:String,attr:"expiredcolor"},expiredcontent:{type:String,attr:"expiredcontent"},expiredvalue:{type:String,attr:"expiredvalue"},ishidden:{type:Boolean,attr:"ishidden"},loading:{state:!0},noreferralsyet:{type:String,attr:"noreferralsyet"},offset:{state:!0},paginateless:{type:String,attr:"paginateless"},paginatemore:{type:String,attr:"paginatemore"},pendingcolor:{type:String,attr:"pendingcolor"},pendingcontent:{type:String,attr:"pendingcontent"},pendingvalue:{type:String,attr:"pendingvalue"},referralnamecolor:{type:String,attr:"referralnamecolor"},referrals:{state:!0},referralsCount:{state:!0},referraltextcolor:{type:String,attr:"referraltextcolor"},referredBy:{state:!0},referrercontent:{type:String,attr:"referrercontent"},referrervalue:{type:String,attr:"referrervalue"},rewardcolor:{type:String,attr:"rewardcolor"},rewards:{state:!0},showreferrer:{type:Boolean,attr:"showreferrer"},unknownuser:{type:String,attr:"unknownuser"},usefirstreward:{type:Boolean,attr:"usefirstreward"},valuecontent:{type:String,attr:"valuecontent"}}}static get style(){return"sqh-referral-list{display:block}sqh-referral-list .squatch-no-referrals-yet{background:#fff;border:1px solid #ccc;border-radius:4px;font-size:14px;line-height:20px;margin:5px;padding:6px 12px;width:165px}sqh-referral-list .squatch-referrals-scroll-container{min-height:255px}sqh-referral-list .squatch-referrals-scroll-action-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:5px 0}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action{background:#fff;border:1px solid #ccc;border-radius:4px;cursor:pointer;font-size:14px;line-height:20px;margin:5px;padding:6px 12px;width:120px}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action.disabled{cursor:default;opacity:.5}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action.disabled:hover{background:#fff;border-color:#ccc}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action.disabled:active{border-style:solid}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action:hover{background:#e6e6e6;border-color:#adadad}sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action:active,sqh-referral-list .squatch-referrals-scroll-action-container .squatch-referrals-scroll-action:focus{outline:0}"}}export{n as SqhReferralComponent,l as SqhReferralList};