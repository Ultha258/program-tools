/*! Built with http://stenciljs.com */
var __makeTemplateObject=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};import{h}from"./widget-components.core.js";import{a as API}from"./chunk-552cea6d.js";import{a as css}from"./chunk-4e957c27.js";import"./chunk-7081a6f1.js";var pathToRegexp_1=pathToRegexp,parse_1=parse,compile_1=compile,tokensToFunction_1=tokensToFunction,tokensToRegExp_1=tokensToRegExp,DEFAULT_DELIMITER="/",DEFAULT_DELIMITERS="./",PATH_REGEXP=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function parse(e,t){for(var n,r=[],a=0,o=0,i="",p=t&&t.delimiter||DEFAULT_DELIMITER,s=t&&t.delimiters||DEFAULT_DELIMITERS,l=!1;null!==(n=PATH_REGEXP.exec(e));){var u=n[0],c=n[1],d=n.index;if(i+=e.slice(o,d),o=d+u.length,c)i+=c[1],l=!0;else{var g="",f=e[o],h=n[2],m=n[3],y=n[4],x=n[5];if(!l&&i.length){var T=i.length-1;s.indexOf(i[T])>-1&&(g=i[T],i=i.slice(0,T))}i&&(r.push(i),i="",l=!1);var E=""!==g&&void 0!==f&&f!==g,R="+"===x||"*"===x,v="?"===x||"*"===x,b=g||p,_=m||y;r.push({name:h||a++,prefix:g,delimiter:b,optional:v,repeat:R,partial:E,pattern:_?escapeGroup(_):"[^"+escapeString(b)+"]+?"})}}return(i||o<e.length)&&r.push(i+e.substr(o)),r}function compile(e,t){return tokensToFunction(parse(e,t))}function tokensToFunction(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,r){for(var a="",o=r&&r.encode||encodeURIComponent,i=0;i<e.length;i++){var p=e[i];if("string"!=typeof p){var s,l=n?n[p.name]:void 0;if(Array.isArray(l)){if(!p.repeat)throw new TypeError('Expected "'+p.name+'" to not repeat, but got array');if(0===l.length){if(p.optional)continue;throw new TypeError('Expected "'+p.name+'" to not be empty')}for(var u=0;u<l.length;u++){if(s=o(l[u],p),!t[i].test(s))throw new TypeError('Expected all "'+p.name+'" to match "'+p.pattern+'"');a+=(0===u?p.prefix:p.delimiter)+s}}else if("string"!=typeof l&&"number"!=typeof l&&"boolean"!=typeof l){if(!p.optional)throw new TypeError('Expected "'+p.name+'" to be '+(p.repeat?"an array":"a string"));p.partial&&(a+=p.prefix)}else{if(s=o(String(l),p),!t[i].test(s))throw new TypeError('Expected "'+p.name+'" to match "'+p.pattern+'", but got "'+s+'"');a+=p.prefix+s}}else a+=p}return a}}function escapeString(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function escapeGroup(e){return e.replace(/([=!:$/()])/g,"\\$1")}function flags(e){return e&&e.sensitive?"":"i"}function regexpToRegexp(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}function arrayToRegexp(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(pathToRegexp(e[a],t,n).source);return new RegExp("(?:"+r.join("|")+")",flags(n))}function stringToRegexp(e,t,n){return tokensToRegExp(parse(e,n),t,n)}function tokensToRegExp(e,t,n){for(var r=(n=n||{}).strict,a=!1!==n.end,o=escapeString(n.delimiter||DEFAULT_DELIMITER),i=n.delimiters||DEFAULT_DELIMITERS,p=[].concat(n.endsWith||[]).map(escapeString).concat("$").join("|"),s="",l=0===e.length,u=0;u<e.length;u++){var c=e[u];if("string"==typeof c)s+=escapeString(c),l=u===e.length-1&&i.indexOf(c[c.length-1])>-1;else{var d=escapeString(c.prefix),g=c.repeat?"(?:"+c.pattern+")(?:"+d+"(?:"+c.pattern+"))*":c.pattern;t&&t.push(c),c.optional?c.partial?s+=d+"("+g+")?":s+="(?:"+d+"("+g+"))?":s+=d+"("+g+")"}}return a?(r||(s+="(?:"+o+")?"),s+="$"===p?"$":"(?="+p+")"):(r||(s+="(?:"+o+"(?="+p+"))?"),l||(s+="(?="+o+"|"+p+")")),new RegExp("^"+s,flags(n))}function pathToRegexp(e,t,n){return e instanceof RegExp?regexpToRegexp(e,t):Array.isArray(e)?arrayToRegexp(e,t,n):stringToRegexp(e,t,n)}pathToRegexp_1.parse=parse_1,pathToRegexp_1.compile=compile_1,pathToRegexp_1.tokensToFunction=tokensToFunction_1,pathToRegexp_1.tokensToRegExp=tokensToRegExp_1;var templateObject_1,StatsContainer=function(){function e(){this.ishidden=!1,this.statPaths=["/rewardBalance/:type/:unit/:valuetype?","/:statName"],this.statPathRegexp=this.statPaths.map(function(e){var t=[];return{regexp:pathToRegexp_1(e,t),keys:t}}),this.loading=!0}return e.prototype.componentWillLoad=function(){var e=this;if(!this.ishidden)return API.graphql.getStats().then(function(t){e.stats={referralsCount:t.referralsCount.totalCount,referralsMonth:t.referralsMonth.totalCount,referralsWeek:t.referralsWeek.totalCount,rewardsCount:t.rewardsCount.totalCount,rewardsMonth:t.rewardsMonth.totalCount,rewardsWeek:t.rewardsWeek.totalCount,rewardBalances:t.rewardBalances},e.loading=!1}).then(function(){Array.from(e.container.querySelectorAll("sqh-stat-component")).map(function(t){e.setStatValue(t)})}).catch(function(t){e.onError(t)})},e.prototype.statTypeUpdatedHandler=function(e){this.setStatValue(e.detail)},e.prototype.statAddedHandler=function(e){this.stats&&this.setStatValue(e.detail)},e.prototype.setStatValue=function(e){var t=e.getAttribute("stattype"),n=this.getStatFromPath(t);return e.setAttribute("statvalue",""+n),e},e.prototype.getStatFromPath=function(e){var t=this.statPathRegexp.find(function(t){return t.regexp.test(e)});if(!t)return 0;var n=t.keys,r=t.regexp.exec(e),a={};return n.forEach(function(e,t){return a[e.name]=r[t+1]}),this.getStatValue(a)},e.prototype.getStatValue=function(e){return e.statName?this.stats[e.statName]||0:this.getRewardBalance(e)},e.prototype.getRewardBalance=function(e){var t=e.type,n=e.unit,r=e.valuetype,a=n.replace(/_/,"/"),o=this.stats.rewardBalances.find(function(e){return e.type===t&&e.unit===a});return o?r?o[r]:o.value:0},e.prototype.onError=function(e){console.log("Error loading via GraphQL.",e),this.loading=!1},e.prototype.render=function(){var e=css(templateObject_1||(templateObject_1=__makeTemplateObject(["\n      display: ",";\n      padding-top: ","px;\n      padding-bottom: ","px;\n    "],["\n      display: ",";\n      padding-top: ","px;\n      padding-bottom: ","px;\n    "])),this.ishidden?"none":"inherit",this.paddingtop,this.paddingbottom);return h("div",{class:e},h("slot",null))},Object.defineProperty(e,"is",{get:function(){return"sqh-stats-container"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{container:{elementRef:!0},ishidden:{type:Boolean,attr:"ishidden"},loading:{state:!0},paddingbottom:{type:String,attr:"paddingbottom"},paddingtop:{type:String,attr:"paddingtop"},stats:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"listeners",{get:function(){return[{name:"statTypeUpdated",method:"statTypeUpdatedHandler"},{name:"statAdded",method:"statAddedHandler"}]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"sqh-stats-container{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}\@media (max-width:499px){sqh-stats-container{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sqh-stats-container div{-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%}}"},enumerable:!0,configurable:!0}),e}();export{StatsContainer as SqhStatsContainer};